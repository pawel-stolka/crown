<div class="help">
  <div>dateRanged: {{ dateRanged }}</div>
  <div>allYears$: {{ allYears$ | async }}</div>
  <div>filteredMoney$: {{ filteredMoney$ | async | json }}</div>
</div>

<div class="actions">
  <div class="row">
    <div class="temp-filters">
      <div class="dateRange">
        <ng-container *ngIf="!dateRanged; then year; else range">
        </ng-container>
      </div>
      <!-- <mat-slide-toggle color="primary" [(ngModel)]="dateRanged">{{
      chooseDatesLabel
    }}</mat-slide-toggle> -->

      <ng-template #year>
        <div class="dateRange2" *ngIf="allYears$ | async as allYears">
          <crown-year-selector
            *ngIf="allYears.length"
            [year]="currentYear$ | async"
            [allYears]="allYears"
            (currentYear)="filterByYear($event)"
          ></crown-year-selector>
        </div>
      </ng-template>

      <ng-template #range>
        <div class="dateRange" disabled>
          <!-- TODO: make separate component !!! -->
          <ng-container *ngIf="dateRange$ | async as dateRange">
            <div class="_dateRange">
              <div class="inline">
                <button
                  mat-stroked-button
                  color="warn"
                  (click)="resetFilters()"
                >
                  domyślne
                </button>
                <mat-dialog-content [formGroup]="filters">
                  <mat-form-field appearance="outline">
                    <mat-label>Od</mat-label>
                    <input
                      matInput
                      [matDatepicker]="fromDatepicker"
                      [value]="dateRange.startDate"
                      #searchInput
                      formControlName="startDate"
                    />

                    <mat-datepicker-toggle matSuffix [for]="fromDatepicker">
                    </mat-datepicker-toggle>

                    <mat-datepicker #fromDatepicker></mat-datepicker>
                  </mat-form-field>
                </mat-dialog-content>
                <mat-dialog-content [formGroup]="filters">
                  <mat-form-field appearance="outline">
                    <mat-label>Do</mat-label>
                    <input
                      matInput
                      [matDatepicker]="toDatepicker"
                      [value]="dateRange.endDate"
                      #searchInput
                      formControlName="endDate"
                    />

                    <mat-datepicker-toggle matSuffix [for]="toDatepicker">
                    </mat-datepicker-toggle>

                    <mat-datepicker #toDatepicker></mat-datepicker>
                  </mat-form-field>
                </mat-dialog-content>
              </div>
            </div>
          </ng-container>

          <mat-slide-toggle
            color="primary"
            [checked]="dateRanged"
            (change)="onToggleChange($event)"
            >no ngModel</mat-slide-toggle
          >
        </div>
      </ng-template>
    </div>

    <div class="add">
      <button mat-fab color="accent" (click)="add()">
        <mat-icon>add</mat-icon>
      </button>
    </div>
  </div>
  <div class="row" *ngIf="(allYears$ | async)?.length">
    <crown-data-filter-3 (filter)="filterByType($event)"></crown-data-filter-3>
  </div>
</div>

<!-- <div *ngIf="message$ | async as message" class="filter-message">
  filter-message...
  {{ message }}
</div> -->
<ng-container *ngIf="filteredMoney$ | async as money; else EMPTY">
  <ng-container *ngIf="money.length > 0; then DATA; else NO_DATA">
  </ng-container>
</ng-container>

<ng-template #DATA>
  <ng-container *ngIf="(monthsData$ | async)?.categories as categories">
    <div class="filter-message">
      <ng-container *ngIf="(filters$ | async)?.type">
        <div class="filter-result" *ngIf="categories.length">
          Znaleziono:
          <span class="categories-amount">{{ categories.length }}</span>
        </div>
      </ng-container>
    </div>
  </ng-container>
  <crown-tabs-container
    [data]="monthsData$ | async"
    [money]="filteredMoney$ | async"
  ></crown-tabs-container>
  <!-- <div *ngIf="pendingFetch$ | async" class="directory-content-loader">
    <mat-spinner [strokeWidth]="2"></mat-spinner>
  </div> -->
</ng-template>

<ng-template #EMPTY>
  <div class="empty">
    <span class="title">Nie znaleziono.</span>
  </div>
</ng-template>

<ng-template #NO_DATA>
  <div class="no-data">
    <span class="title">Nic tu jeszcze nie ma</span>
    <span class="subtitle">Dodaj coś ☝️ (+)</span>
  </div>
</ng-template>
